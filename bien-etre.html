<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bo√Æte √† Outils Relationnelle : Aider et se Prot√©ger</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony Palette -->
    <!-- Application Structure Plan: A single-page app with a fixed sidebar navigation for intuitive access to different thematic sections: 'Accueil', 'Comprendre la Dynamique', 'Strat√©gies d'Action', 'Ressources √† Rennes', and 'Outils Pratiques'. This task-oriented structure is chosen over a linear report format to allow the user to quickly find the specific information they need (e.g., immediate coping strategies vs. deep psychological understanding), thus enhancing usability for a user in distress. Key interactions include toggling views between helping the partner and self-preservation, filterable resource lists, and interactive concept explainers (accordions/diagrams) to make complex information digestible. -->
    <!-- Visualization & Content Choices: Psychological Schemas -> Goal: Organize/Inform -> Viz: Interactive Radar Chart (illustrative) & Accordion Cards -> Interaction: Click-to-reveal -> Justification: Breaks down dense theory into manageable, explorable chunks. Chart.js used for visual engagement. Karpman Triangle -> Goal: Organize -> Viz: HTML/CSS Diagram with Clickable Vertices for Descriptions -> Interaction: Click on a role to display its definition -> Justification: Visually represents the core toxic dynamic and allows for interactive learning of each role. Do's & Don'ts -> Goal: Guide -> Viz: Icon-driven lists -> Justification: Quick, scannable advice. Resources -> Goal: Provide -> Viz: Filterable card list -> Justification: Improves on a static list, making it a usable tool. Audio Content -> Goal: Inform (Passive) -> Viz: HTML5 Audio Player -> Justification: Provides an alternative consumption method for report summary/key takeaways. LLM Feature 1 (Reformuler) -> Goal: Communication Aid -> Viz: Text Input/Output -> Interaction: User input, LLM reformulates text -> Justification: Directly addresses communication challenges with dynamic, AI-powered rephrasing. LLM Feature 2 (R√©flexion) -> Goal: Emotional Processing -> Viz: Text Input/Output -> Interaction: User input, LLM provides reflective summary -> Justification: Offers a unique, private journaling and self-awareness tool using AI. NO SVG/Mermaid used. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4B4B4B;
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .nav-link.active {
            background-color: #EADDCD;
            color: #5D4037;
            font-weight: 600;
        }
        .nav-link:not(.active):hover {
            background-color: #F5F1EB;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .card {
            background-color: #FFFFFF;
            border: 1px solid #EFEBE9;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .karpman-triangle {
            position: relative;
            width: 300px;
            height: 260px;
            margin: 2rem auto;
        }
        .karpman-vertex {
            position: absolute;
            width: 100px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            border-radius: 0.5rem;
            padding: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .karpman-vertex:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px -2px rgba(0, 0, 0, 0.1);
        }
        .karpman-vertex.active-vertex {
            transform: scale(1.05);
            box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.2);
            border: 2px solid #5D4037;
        }
        .karpman-line {
            position: absolute;
            background-color: #D7CCC8;
            transform-origin: 0 0;
        }
        .tab-btn.active {
            border-bottom: 2px solid #5D4037;
            color: #5D4037;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 40vh;
            max-height: 400px;
            width: 100%;
            max-width: 500px;
        }
        .karpman-description-container {
            min-height: 100px; /* Ensure space even when empty */
        }
        .llm-output-box {
            background-color: #f9f9f9;
            border: 1px solid #e0e0e0;
            border-radius: 0.5rem;
            padding: 1rem;
            min-height: 80px;
            margin-top: 1rem;
            font-size: 0.95rem;
            color: #333;
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #5D4037;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="antialiased">

    <div class="flex flex-col md:flex-row min-h-screen">
        <!-- Sidebar Navigation -->
        <nav class="md:w-64 bg-white/80 backdrop-blur-sm border-r border-gray-200/50 md:fixed md:h-full">
            <div class="p-6">
                <h1 class="text-xl font-bold text-stone-700">Bo√Æte √† Outils</h1>
                <p class="text-sm text-stone-500 mt-1">Aider et se Prot√©ger</p>
            </div>
            <ul class="flex md:flex-col p-2 md:p-4 space-x-2 md:space-x-0 md:space-y-2 overflow-x-auto">
                <li><a href="#accueil" class="nav-link flex items-center p-3 rounded-lg">üè† Accueil</a></li>
                <li><a href="#dynamique" class="nav-link flex items-center p-3 rounded-lg">üß† Comprendre</a></li>
                <li><a href="#strategies" class="nav-link flex items-center p-3 rounded-lg">üõ†Ô∏è Strat√©gies</a></li>
                <li><a href="#ressources" class="nav-link flex items-center p-3 rounded-lg">üìç Ressources</a></li>
                <li><a href="#outils" class="nav-link flex items-center p-3 rounded-lg">üßò Outils Pratiques</a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="flex-1 md:ml-64 p-4 sm:p-6 lg:p-8">
            <!-- Section: Accueil -->
            <section id="accueil" class="content-section">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-3xl font-bold text-stone-800 mb-4">Naviguer les d√©fis relationnels avec compassion et force</h2>
                    <p class="text-lg text-stone-600 mb-6">
                        Bienvenue dans votre espace de soutien. Aider un proche qui souffre tout en se prot√©geant est un chemin complexe et souvent solitaire. Cette application est con√ßue pour vous fournir des cl√©s de compr√©hension, des strat√©gies concr√®tes et des ressources fiables pour transformer cette dynamique difficile. Vous n'√™tes pas seul(e).
                    </p>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="card p-6 rounded-xl">
                            <h3 class="font-bold text-xl text-stone-700 mb-2">Comprendre pour mieux agir</h3>
                            <p class="text-stone-600">Explorez les m√©canismes psychologiques qui sous-tendent la situation pour mieux cerner les enjeux et adapter votre soutien.</p>
                        </div>
                        <div class="card p-6 rounded-xl">
                            <h3 class="font-bold text-xl text-stone-700 mb-2">Prendre soin de vous</h3>
                            <p class="text-stone-600">D√©couvrez des strat√©gies essentielles pour g√©rer la culpabilit√©, poser des limites et vous lib√©rer du r√¥le de "sauveur" pour ne pas vous √©puiser.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Comprendre la Dynamique -->
            <section id="dynamique" class="content-section">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">D√©crypter les Dynamiques Psychologiques</h2>
                <p class="text-lg text-stone-600 mb-8">Comprendre les sch√©mas de pens√©e et les r√¥les inconscients est la premi√®re √©tape pour briser les cycles r√©p√©titifs et douloureux.</p>

                <div class="grid lg:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-2xl font-bold text-stone-700 mb-4">Sch√©mas Pr√©coces Inadapt√©s</h3>
                        <p class="text-stone-600 mb-4">Ce sont des mod√®les de pens√©e et de sentiment profond√©ment enracin√©s, souvent d√©velopp√©s durant l'enfance, qui filtrent la r√©alit√© et influencent les r√©actions de votre partenaire.</p>
                        <div class="space-y-2" id="schemas-accordion"></div>
                        <div class="mt-8">
                             <h4 class="font-semibold text-stone-700 mb-2">Visualisation (Illustrative)</h4>
                             <p class="text-sm text-stone-500 mb-4">Ce graphique illustre comment plusieurs sch√©mas peuvent coexister avec des intensit√©s diff√©rentes. Il ne s'agit pas d'un diagnostic, mais d'une repr√©sentation visuelle du concept.</p>
                             <div class="chart-container">
                                 <canvas id="schemasChart"></canvas>
                             </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-2xl font-bold text-stone-700 mb-4">Distorsions Cognitives</h3>
                        <p class="text-stone-600 mb-4">Ce sont des raccourcis mentaux qui d√©forment la r√©alit√© et renforcent les croyances n√©gatives. Les reconna√Ætre est essentiel pour une communication apais√©e.</p>
                        <div class="space-y-2" id="distortions-accordion"></div>
                        
                        <h3 class="text-2xl font-bold text-stone-700 mt-8 mb-4">Le Triangle Dramatique de Karpman</h3>
                        <p class="text-stone-600 mb-4">Ce mod√®le illustre une dynamique relationnelle toxique o√π les individus alternent entre trois r√¥les inconscients. Cliquez sur chaque r√¥le pour en savoir plus.</p>
                        <div class="karpman-triangle" aria-label="Triangle de Karpman avec les sommets Victime, Pers√©cuteur et Sauveur">
                            <button class="karpman-vertex bg-amber-100 text-amber-800" style="top: 0; left: 100px;" data-role="Victime">Victime</button>
                            <button class="karpman-vertex bg-red-100 text-red-800" style="bottom: 0; left: 0;" data-role="Pers√©cuteur">Pers√©cuteur</button>
                            <button class="karpman-vertex bg-sky-100 text-sky-800" style="bottom: 0; right: 0;" data-role="Sauveur">Sauveur</button>
                            <!-- Lines for visual connection -->
                            <div class="karpman-line" style="width: 250px; height: 2px; top: 30px; left: 25px; transform: rotate(0deg);"></div>
                            <div class="karpman-line" style="width: 280px; height: 2px; top: 30px; left: 25px; transform: rotate(60deg);"></div>
                            <div class="karpman-line" style="width: 280px; height: 2px; top: 258px; left: 150px; transform: rotate(120deg);"></div>
                        </div>
                        <div id="karpman-description" class="karpman-description-container card p-4 rounded-xl mt-4 text-stone-600 hidden"></div>
                    </div>
                </div>
            </section>

            <!-- Section: Strat√©gies d'Action -->
            <section id="strategies" class="content-section">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Strat√©gies d'Action au Quotidien</h2>
                <p class="text-lg text-stone-600 mb-8">Trouver le juste √©quilibre entre soutenir l'autre et vous prot√©ger. Naviguez entre les deux approches pour des conseils cibl√©s.</p>
                <div class="border-b border-gray-200 mb-6">
                    <nav class="flex -mb-px" id="strategies-tabs">
                        <button class="tab-btn active w-1/2 py-4 px-1 text-center font-medium text-lg" data-target="aider-content">ü§ù Aider votre partenaire</button>
                        <button class="tab-btn w-1/2 py-4 px-1 text-center font-medium text-lg text-gray-500" data-target="proteger-content">üõ°Ô∏è Vous pr√©server</button>
                    </nav>
                </div>
                
                <div id="aider-content" class="strategies-content-pane">
                    <h3 class="text-2xl font-bold text-stone-700 mb-6">Communiquer avec Empathie et Efficacit√©</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold text-lg text-green-700 mb-3">‚úîÔ∏è √Ä faire</h4>
                            <ul class="space-y-3">
                                <li class="flex items-start"><span class="text-green-500 mr-3 mt-1">‚úì</span><div><strong class="font-semibold">√âcouter activement :</strong> Validez ses √©motions sans juger. "Je comprends que ce soit dur pour toi."</div></li>
                                <li class="flex items-start"><span class="text-green-500 mr-3 mt-1">‚úì</span><div><strong class="font-semibold">Parler au "Je" :</strong> Exprimez vos ressentis. "Je m'inqui√®te quand je te vois t'isoler."</div></li>
                                <li class="flex items-start"><span class="text-green-500 mr-3 mt-1">‚úì</span><div><strong class="font-semibold">√ätre pr√©sent, m√™me en silence :</strong> Proposez une pr√©sence simple et non pressante.</div></li>
                                <li class="flex items-start"><span class="text-green-500 mr-3 mt-1">‚úì</span><div><strong class="font-semibold">Valoriser les petits pas :</strong> Reconnaissez chaque effort, aussi minime soit-il.</div></li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-lg text-red-700 mb-3">‚ùå √Ä √©viter</h4>
                            <ul class="space-y-3">
                                <li class="flex items-start"><span class="text-red-500 mr-3 mt-1">‚úó</span><div><strong class="font-semibold">Minimiser sa souffrance :</strong> √âvitez les "√áa va aller" ou "Secoue-toi un peu".</div></li>
                                <li class="flex items-start"><span class="text-red-500 mr-3 mt-1">‚úó</span><div><strong class="font-semibold">Forcer la discussion :</strong> La pression peut entra√Æner un retrait encore plus grand.</div></li>
                                <li class="flex items-start"><span class="text-red-500 mr-3 mt-1">‚úó</span><div><strong class="font-semibold">Prendre la col√®re personnellement :</strong> C'est souvent un sympt√¥me de la d√©tresse, pas une attaque contre vous.</div></li>
                                <li class="flex items-start"><span class="text-red-500 mr-3 mt-1">‚úó</span><div><strong class="font-semibold">Argumenter contre les distorsions :</strong> Ne dites pas "C'est faux", mais questionnez doucement : "Cette pens√©e t'aide-t-elle ?".</div></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="proteger-content" class="strategies-content-pane hidden">
                    <h3 class="text-2xl font-bold text-stone-700 mb-6">Se Prot√©ger pour Mieux Soutenir</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <h4 class="font-semibold text-lg text-stone-700 mb-3">G√©rer la Culpabilit√©</h4>
                            <ul class="space-y-3">
                                <li class="flex items-start"><span class="text-sky-500 mr-3 mt-1">‚óè</span><div><strong class="font-semibold">Acceptez vos √©motions :</strong> Il est normal de ressentir de la frustration ou de la fatigue. Soyez compatissant envers vous-m√™me.</div></li>
                                <li class="flex items-start"><span class="text-sky-500 mr-3 mt-1">‚óè</span><div><strong class="font-semibold">Fixez des objectifs r√©alistes :</strong> Vous ne pouvez pas tout faire, ni tout contr√¥ler. Acceptez vos limites.</div></li>
                                <li class="flex items-start"><span class="text-sky-500 mr-3 mt-1">‚óè</span><div><strong class="font-semibold">Prenez du temps pour vous :</strong> Planifiez des activit√©s qui vous ressourcent. Ce n'est pas √©go√Øste, c'est vital.</div></li>
                            </ul>
                        </div>
                        <div>
                            <h4 class="font-semibold text-lg text-stone-700 mb-3">Poser des Limites Saines</h4>
                            <ul class="space-y-3">
                                <li class="flex items-start"><span class="text-sky-500 mr-3 mt-1">‚óè</span><div><strong class="font-semibold">D√©finissez votre r√¥le :</strong> Vous √™tes un soutien, pas un sauveur. Vous ne pouvez pas faire le travail √† sa place.</div></li>
                                <li class="flex items-start"><span class="text-sky-500 mr-3 mt-1">‚óè</span><div><strong class="font-semibold">Ne portez pas seul le fardeau :</strong> Si l'aide est constamment n√©cessaire, un soutien professionnel est requis.</div></li>
                                <li class="flex items-start"><span class="text-sky-500 mr-3 mt-1">‚óè</span><div><strong class="font-semibold">Communiquez vos limites :</strong> Exprimez clairement et calmement vos besoins et ce que vous ne pouvez pas accepter.</div></li>
                                <li class="flex items-start"><span class="text-sky-500 mr-3 mt-1">‚óè</span><div><strong class="font-semibold">Cherchez du soutien :</strong> Parlez √† des amis, √† votre famille, ou rejoignez un groupe de soutien pour aidants.</div></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section: Ressources -->
            <section id="ressources" class="content-section">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Ressources Professionnelles √† Rennes</h2>
                <p class="text-lg text-stone-600 mb-8">Trouver le bon soutien est une √©tape essentielle. Voici une liste de professionnels et d'associations pour vous et votre partenaire.</p>
                <div class="mb-6">
                    <input type="text" id="resource-search" placeholder="Rechercher par nom, sp√©cialit√©..." class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-stone-400 focus:border-stone-400 transition">
                </div>
                <div class="border-b border-gray-200 mb-6">
                    <nav class="flex -mb-px" id="resources-tabs">
                        <button class="tab-btn active w-1/3 py-4 px-1 text-center font-medium" data-category="psy-individuel">Individuel</button>
                        <button class="tab-btn w-1/3 py-4 px-1 text-center font-medium text-gray-500" data-category="psy-couple">Couple</button>
                        <button class="tab-btn w-1/3 py-4 px-1 text-center font-medium text-gray-500" data-category="association">Associations</button>
                    </nav>
                </div>
                <div id="resources-list" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Resource cards will be injected here by JavaScript -->
                </div>
            </section>
            
            <!-- Section: Outils -->
            <section id="outils" class="content-section">
                <h2 class="text-3xl font-bold text-stone-800 mb-2">Outils Pratiques et Approches Indirectes</h2>
                <p class="text-lg text-stone-600 mb-8">Pour un partenaire r√©sistant √† la th√©rapie, des approches plus douces peuvent ouvrir la voie au bien-√™tre sans confrontation directe.</p>

                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-2xl font-bold text-stone-700 mb-4">La Pleine Conscience (Mindfulness)</h3>
                        <p class="text-stone-600 mb-4">La pleine conscience aide √† observer ses pens√©es et √©motions sans jugement, r√©duisant ainsi leur emprise. C'est une comp√©tence qui se cultive avec la pratique.</p>
                        <div class="card p-6 rounded-xl">
                            <h4 class="font-semibold text-lg text-stone-700 mb-3">Exercice simple : Les 5 Sens</h4>
                            <p class="text-stone-600 mb-4">Ancrez-vous dans le moment pr√©sent avec cet exercice rapide. Prenez une grande inspiration et identifiez :</p>
                            <ul class="space-y-2 list-disc list-inside text-stone-600">
                                <li><strong>5</strong> choses que vous pouvez VOIR</li>
                                <li><strong>4</strong> choses que vous pouvez SENTIR (au toucher)</li>
                                <li><strong>3</strong> choses que vous pouvez ENTENDRE</li>
                                <li><strong>2</strong> choses que vous pouvez ODORER</li>
                                <li><strong>1</strong> chose que vous pouvez GO√õTER</li>
                            </ul>
                        </div>
                    </div>
                    <div>
                        <h3 class="text-2xl font-bold text-stone-700 mb-4">Th√©rapie d'Acceptation et d'Engagement (ACT)</h3>
                        <p class="text-stone-600 mb-4">L'ACT ne cherche pas √† √©liminer les pens√©es n√©gatives, mais √† d√©velopper la flexibilit√© psychologique pour agir en accord avec ses valeurs, m√™me en pr√©sence de difficult√©s.</p>
                        <div class="card p-6 rounded-xl">
                             <h4 class="font-semibold text-lg text-stone-700 mb-3">Applications recommand√©es</h4>
                             <p class="text-stone-600 mb-4">Ces applications peuvent √™tre une porte d'entr√©e accessible et priv√©e vers la m√©ditation et la pleine conscience.</p>
                             <ul class="space-y-2" id="apps-list">
                                <!-- App list will be injected here -->
                             </ul>
                        </div>
                    </div>
                </div>
                
                <div class="mt-12 max-w-2xl mx-auto">
                    <h3 class="text-2xl font-bold text-stone-700 mb-4">√âcouter pour Comprendre (Audio)</h3>
                    <p class="text-stone-600 mb-4">
                        Parfois, √©couter un r√©sum√© ou une explication peut faciliter l'assimilation d'informations complexes. Vous pouvez t√©l√©charger et h√©berger un fichier audio (par exemple, un r√©sum√© des concepts cl√©s du rapport) et l'int√©grer ci-dessous.
                    </p>
                    <div class="card p-6 rounded-xl">
                        <h4 class="font-semibold text-lg text-stone-700 mb-3">R√©sum√© Audio du Rapport</h4>
                        <audio controls class="w-full mt-2 rounded-lg" aria-label="R√©sum√© audio du rapport">
                            <source src="VOTRE_URL_AUDIO_ICI.mp3" type="audio/mpeg">
                            Votre navigateur ne supporte pas l'√©l√©ment audio.
                        </audio>
                        <p class="text-sm text-stone-500 mt-2">
                            Remplacez "VOTRE_URL_AUDIO_ICI.mp3" par le lien direct vers votre fichier audio (par exemple, un r√©sum√© que vous avez enregistr√©).
                        </p>
                    </div>
                </div>

                <div class="mt-12 max-w-2xl mx-auto">
                    <h3 class="text-2xl font-bold text-stone-700 mb-4">Reformuler avec clart√© ‚ú®</h3>
                    <p class="text-stone-600 mb-4">
                        Tapez une phrase difficile, √©motionnelle ou conflictuelle. L'IA vous aidera √† la reformuler de mani√®re plus constructive ou √† utiliser des "messages en Je" pour une meilleure communication.
                    </p>
                    <div class="card p-6 rounded-xl">
                        <textarea id="rephrase-input" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-stone-400 focus:border-stone-400 transition" rows="4" placeholder="Exprimez votre pens√©e ici..."></textarea>
                        <button id="rephrase-btn" class="mt-4 w-full bg-stone-700 text-white py-2 px-4 rounded-lg hover:bg-stone-800 transition flex items-center justify-center">
                            <span id="rephrase-btn-text">Reformuler avec clart√©</span>
                            <div id="rephrase-spinner" class="loading-spinner hidden ml-2"></div>
                        </button>
                        <div id="rephrase-output" class="llm-output-box mt-4 text-stone-600"></div>
                    </div>
                </div>

                <div class="mt-12 max-w-2xl mx-auto">
                    <h3 class="text-2xl font-bold text-stone-700 mb-4">Mon espace de r√©flexion ‚ú®</h3>
                    <p class="text-stone-600 mb-4">
                        √âcrivez ce qui vous p√®se, une situation que vous avez v√©cue ou vos √©motions du moment. L'IA vous offrira une r√©flexion neutre ou une question pour vous aider √† explorer vos pens√©es.
                    </p>
                    <div class="card p-6 rounded-xl">
                        <textarea id="reflect-input" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-stone-400 focus:border-stone-400 transition" rows="4" placeholder="D√©crivez votre situation ou vos √©motions..."></textarea>
                        <button id="reflect-btn" class="mt-4 w-full bg-stone-700 text-white py-2 px-4 rounded-lg hover:bg-stone-800 transition flex items-center justify-center">
                            <span id="reflect-btn-text">R√©fl√©chir avec Gemini</span>
                            <div id="reflect-spinner" class="loading-spinner hidden ml-2"></div>
                        </button>
                        <div id="reflect-output" class="llm-output-box mt-4 text-stone-600"></div>
                    </div>
                </div>
            </section>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const navLinks = document.querySelectorAll('.nav-link');
    const contentSections = document.querySelectorAll('.content-section');

    function showSection(hash) {
        const targetHash = hash || '#accueil';
        navLinks.forEach(link => {
            link.classList.toggle('active', link.getAttribute('href') === targetHash);
        });
        contentSections.forEach(section => {
            section.classList.toggle('active', '#' + section.id === targetHash);
        });
    }
    
    navLinks.forEach(link => {
        link.addEventListener('click', function (e) {
            e.preventDefault();
            const targetHash = this.getAttribute('href');
            history.pushState(null, null, targetHash);
            showSection(targetHash);
        });
    });

    window.addEventListener('popstate', () => {
        showSection(window.location.hash);
    });

    showSection(window.location.hash);
    
    // --- ACCORDIONS ---
    const schemasData = [
        { title: "Manque Affectif", content: "La certitude que les autres ne fourniront pas le soutien affectif n√©cessaire (attention, affection, empathie)." },
        { title: "Imperfection/Honte", content: "Le sentiment d'√™tre imparfait, 'mauvais' ou inf√©rieur, craignant le jugement des autres." },
        { title: "Abandon/Instabilit√©", content: "La peur que les personnes importantes ne puissent pas continuer √† apporter un soutien fiable et stable." },
        { title: "Isolement Social", content: "Le sentiment d'√™tre diff√©rent, coup√© du reste du monde et de ne faire partie d'aucun groupe." },
        { title: "Fusionnement", content: "Un sentiment de vide ou de crise identitaire en l'absence d'une relation fusionnelle." },
        { title: "Assujettissement", content: "La suppression de ses propres d√©sirs pour r√©pondre aux besoins des autres, souvent par peur de les blesser." }
    ];

    const distortionsData = [
        { title: "T√©l√©pathie", content: "Croire savoir ce que les autres pensent sans aucune preuve." },
        { title: "Filtre Mental", content: "Se focaliser sur un d√©tail n√©gatif au point d'occulter tout le reste." },
        { title: "Surg√©n√©ralisation", content: "Tirer une conclusion n√©gative globale √† partir d'un seul √©v√©nement." },
        { title: "Personnalisation", content: "Se sentir responsable d'√©v√©nements ext√©rieurs qui ne d√©pendent pas de soi." },
        { title: "Pens√©e Tout ou Rien", content: "Voir les choses en noir et blanc, sans nuances." },
        { title: "Raisonnement √âmotionnel", content: "Croire que ses √©motions refl√®tent la r√©alit√© objective." },
    ];

    function createAccordion(containerId, data) {
        const container = document.getElementById(containerId);
        data.forEach((item, index) => {
            const wrapper = document.createElement('div');
            wrapper.className = 'card rounded-lg overflow-hidden';
            
            const button = document.createElement('button');
            button.className = 'w-full p-4 text-left font-semibold flex justify-between items-center transition-colors hover:bg-stone-50';
            button.innerHTML = `<span>${item.title}</span><span class="transform transition-transform duration-300">‚ñº</span>`;
            
            const content = document.createElement('div');
            content.className = 'accordion-content px-4';
            content.innerHTML = `<p class="pb-4 text-stone-600">${item.content}</p>`;

            wrapper.appendChild(button);
            wrapper.appendChild(content);
            container.appendChild(wrapper);

            button.addEventListener('click', () => {
                const isOpening = content.style.maxHeight === '0px' || !content.style.maxHeight;
                // Close all others
                container.querySelectorAll('.accordion-content').forEach(c => c.style.maxHeight = '0px');
                container.querySelectorAll('button span:last-child').forEach(s => s.style.transform = 'rotate(0deg)');
                
                if (isOpening) {
                    content.style.maxHeight = content.scrollHeight + 'px';
                    button.querySelector('span:last-child').style.transform = 'rotate(180deg)';
                }
            });
        });
    }

    createAccordion('schemas-accordion', schemasData);
    createAccordion('distortions-accordion', distortionsData);

    // --- STRATEGIES TABS ---
    const strategiesTabs = document.getElementById('strategies-tabs');
    const strategiesPanes = document.querySelectorAll('.strategies-content-pane');
    strategiesTabs.addEventListener('click', e => {
        if (e.target.tagName === 'BUTTON') {
            strategiesTabs.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            
            strategiesPanes.forEach(pane => {
                pane.classList.add('hidden');
                if(pane.id === e.target.dataset.target) {
                    pane.classList.remove('hidden');
                }
            });
        }
    });

    // --- RESOURCES ---
    const resourcesData = [
        // Individuel
        { category: "psy-individuel", name: "Emeric Biver", specialty: "Psychopraticien, Approche existentielle et int√©grative", contact: "Rennes" },
        { category: "psy-individuel", name: "David Ison", specialty: "Psychopraticien, Gestalt-th√©rapie", contact: "Rennes" },
        { category: "psy-individuel", name: "Benjamin Gauducheau", specialty: "Gestalt-praticien (d√©pression, anxi√©t√©)", contact: "Rennes" },
        { category: "psy-individuel", name: "Zehra Demir", specialty: "Psychologue, TCC & EMDR (en ligne)", contact: "Rennes" },
        { category: "psy-individuel", name: "R√©mi Abida", specialty: "Psychologue, Approche centr√©e sur la personne", contact: "Rennes" },
        // Couple
        { category: "psy-couple", name: "St√©phane Arfi", specialty: "Th√©rapeute de couple", contact: "Rennes" },
        { category: "psy-couple", name: "Gwenn Melscoet", specialty: "Th√©rapie de couple, M√©diation CNV", contact: "Rennes" },
        // Associations
        { category: "association", name: "UNAFAM Ille-et-Vilaine", specialty: "Soutien aux familles de malades psychiques, groupes de parole", contact: "02 99 53 88 93 | 35@unafam.org" },
        { category: "association", name: "CREFAP", specialty: "Centre Ressource Familles et Maladies Psychiques", contact: "02 99 33 60 22 | crefap@ch-guillaumeregnier.fr" },
        { category: "association", name: "Lueur d'espoir SOS D√©pression 35", specialty: "√âcoute t√©l√©phonique et permanences", contact: "02 99 83 65 28" },
        { category: "association", name: "SOS Amiti√© Rennes", specialty: "√âcoute anonyme 24h/24 et 7j/7", contact: "09 72 39 40 50" },
    ];
    
    const resourcesList = document.getElementById('resources-list');
    const resourcesTabs = document.getElementById('resources-tabs');
    const resourceSearch = document.getElementById('resource-search');
    let currentCategory = 'psy-individuel';

    function renderResources(category, searchTerm = '') {
        resourcesList.innerHTML = '';
        const filteredData = resourcesData.filter(r => 
            r.category === category && 
            (r.name.toLowerCase().includes(searchTerm.toLowerCase()) || r.specialty.toLowerCase().includes(searchTerm.toLowerCase()))
        );

        if (filteredData.length === 0) {
            resourcesList.innerHTML = `<p class="text-stone-500 col-span-full text-center">Aucune ressource trouv√©e pour cette recherche.</p>`;
            return;
        }
        
        filteredData.forEach(r => {
            const card = document.createElement('div');
            card.className = 'resource-card card p-5 rounded-xl flex flex-col justify-between';
            card.innerHTML = `
                <div>
                    <h4 class="font-bold text-lg text-stone-800">${r.name}</h4>
                    <p class="text-stone-600 text-sm mt-1">${r.specialty}</p>
                </div>
                <p class="text-stone-500 text-xs mt-4 font-mono">${r.contact}</p>
            `;
            resourcesList.appendChild(card);
        });
    }

    resourcesTabs.addEventListener('click', e => {
        if (e.target.tagName === 'BUTTON') {
            currentCategory = e.target.dataset.category;
            resourcesTabs.querySelectorAll('button').forEach(btn => btn.classList.remove('active'));
            e.target.classList.add('active');
            renderResources(currentCategory, resourceSearch.value);
        }
    });

    resourceSearch.addEventListener('input', () => {
        renderResources(currentCategory, resourceSearch.value);
    });

    renderResources(currentCategory);

    // --- APPS LIST ---
    const appsData = [
        { name: "Petit Bambou", features: "S√©ances guid√©es, large contenu gratuit." },
        { name: "Mind", features: "Programmes th√©matiques, design √©pur√©." },
        { name: "Calm", features: "Aide au sommeil, musiques de concentration." },
        { name: "Insight Timer", features: "Immense biblioth√®que gratuite." },
    ];
    const appsListContainer = document.getElementById('apps-list');
    appsData.forEach(app => {
        const li = document.createElement('li');
        li.className = "flex items-start";
        li.innerHTML = `<span class="text-sky-500 mr-3 mt-1">üì±</span><div><strong class="font-semibold">${app.name}:</strong> ${app.features}</div>`;
        appsListContainer.appendChild(li);
    });

    // --- SCHEMAS CHART ---
    const ctx = document.getElementById('schemasChart').getContext('2d');
    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: schemasData.map(s => s.title.split(' ')[0]),
            datasets: [{
                label: 'Intensit√© du Sch√©ma (Illustratif)',
                data: [8, 6, 7, 5, 4, 6],
                backgroundColor: 'rgba(93, 64, 55, 0.2)',
                borderColor: 'rgb(93, 64, 55)',
                borderWidth: 2,
                pointBackgroundColor: 'rgb(93, 64, 55)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgb(93, 64, 55)'
            }]
        },
        options: {
            maintainAspectRatio: false,
            scales: {
                r: {
                    angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                    grid: { color: 'rgba(0, 0, 0, 0.1)' },
                    pointLabels: { 
                        font: { size: 12 },
                        color: '#4B4B4B'
                    },
                    ticks: {
                        backdropColor: 'rgba(255, 255, 255, 0.75)',
                        stepSize: 2
                    },
                    suggestedMin: 0,
                    suggestedMax: 10
                }
            },
            plugins: {
                legend: {
                    position: 'top',
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return ` Intensit√©: ${context.raw}`;
                        }
                    }
                }
            }
        }
    });

    // --- KARPMAN TRIANGLE INTERACTIVITY ---
    const karpmanVertices = document.querySelectorAll('.karpman-vertex');
    const karpmanDescription = document.getElementById('karpman-description');

    const karpmanRoles = {
        "Victime": "La Victime se sent impuissante, incapable de r√©soudre ses probl√®mes, et cherche constamment √† √™tre secourue ou prise en charge. Elle √©vite la responsabilit√© de ses propres actions.",
        "Pers√©cuteur": "Le Pers√©cuteur critique, bl√¢me, contr√¥le, et humilie. Il exerce un pouvoir sur la Victime et le Sauveur, souvent en projetant ses propres frustrations et ins√©curit√©s.",
        "Sauveur": "Le Sauveur se sent responsable des probl√®mes des autres et tente de les aider, souvent sans que son aide soit sollicit√©e ou n√©cessaire. Il a besoin d'une Victime pour se sentir valoris√© et puissant, et peut involontairement emp√™cher l'autonomie de la Victime."
    };

    karpmanVertices.forEach(vertex => {
        vertex.addEventListener('click', function() {
            const role = this.dataset.role;

            // Remove active class from all vertices
            karpmanVertices.forEach(v => v.classList.remove('active-vertex'));
            // Add active class to the clicked vertex
            this.classList.add('active-vertex');

            // Update description
            karpmanDescription.innerHTML = `<strong>${role} :</strong> ${karpmanRoles[role]}`;
            karpmanDescription.classList.remove('hidden');
        });
    });

    // --- GEMINI LLM INTEGRATIONS ---
    const apiKey = ""; // API key will be provided by the Canvas runtime if left empty.

    // Feature 1: Rephrase with Clarity
    const rephraseInput = document.getElementById('rephrase-input');
    const rephraseBtn = document.getElementById('rephrase-btn');
    const rephraseBtnText = document.getElementById('rephrase-btn-text');
    const rephraseSpinner = document.getElementById('rephrase-spinner');
    const rephraseOutput = document.getElementById('rephrase-output');

    rephraseBtn.addEventListener('click', async () => {
        const prompt = rephraseInput.value;
        if (!prompt.trim()) {
            rephraseOutput.textContent = "Veuillez entrer du texte √† reformuler.";
            return;
        }

        rephraseBtn.disabled = true;
        rephraseBtnText.textContent = "Reformulation...";
        rephraseSpinner.classList.remove('hidden');
        rephraseOutput.textContent = "";

        let chatHistory = [];
        chatHistory.push({ role: "user", parts: [{ text: `Reformule cette phrase de mani√®re plus claire, constructive ou sous forme de "message en Je", sans changer le sens fondamental, et en fran√ßais : "${prompt}"` }] });
        const payload = { contents: chatHistory };
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            const result = await response.json();
            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                const text = result.candidates[0].content.parts[0].text;
                rephraseOutput.textContent = text;
            } else {
                rephraseOutput.textContent = "D√©sol√©, je n'ai pas pu reformuler cela. Veuillez r√©essayer.";
            }
        } catch (error) {
            console.error('Erreur lors de l\'appel √† l\'API Gemini (Reformuler):', error);
            rephraseOutput.textContent = "Une erreur est survenue lors de la reformulation. Veuillez v√©rifier votre connexion.";
        } finally {
            rephraseBtn.disabled = false;
            rephraseBtnText.textContent = "Reformuler avec clart√©";
            rephraseSpinner.classList.add('hidden');
        }
    });

    // Feature 2: Reflection Space
    const reflectInput = document.getElementById('reflect-input');
    const reflectBtn = document.getElementById('reflect-btn');
    const reflectBtnText = document.getElementById('reflect-btn-text');
    const reflectSpinner = document.getElementById('reflect-spinner');
    const reflectOutput = document.getElementById('reflect-output');

    reflectBtn.addEventListener('click', async () => {
        const prompt = reflectInput.value;
        if (!prompt.trim()) {
            reflectOutput.textContent = "Veuillez d√©crire vos pens√©es ou une situation.";
            return;
        }

        reflectBtn.disabled = true;
        reflectBtnText.textContent = "R√©flexion en cours...";
        reflectSpinner.classList.remove('hidden');
        reflectOutput.textContent = "";

        let chatHistory = [];
        chatHistory.push({ role: "user", parts: [{ text: `Je vais te d√©crire une situation ou mes √©motions. Ton r√¥le est de fournir une br√®ve r√©flexion empathique, neutre et non-jugeante sur le contenu, ou de poser une question ouverte pour m'aider √† explorer mes pens√©es. Ne me donne pas de conseils directs. R√©ponds en fran√ßais. Voici ce que je veux exprimer : "${prompt}"` }] });
        const payload = { contents: chatHistory };
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            const result = await response.json();
            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                const text = result.candidates[0].content.parts[0].text;
                reflectOutput.textContent = text;
            } else {
                reflectOutput.textContent = "D√©sol√©, je n'ai pas pu g√©n√©rer de r√©flexion. Veuillez r√©essayer.";
            }
        } catch (error) {
            console.error('Erreur lors de l\'appel √† l\'API Gemini (R√©flexion):', error);
            reflectOutput.textContent = "Une erreur est survenue lors de la r√©flexion. Veuillez v√©rifier votre connexion.";
        } finally {
            reflectBtn.disabled = false;
            reflectBtnText.textContent = "R√©fl√©chir avec Gemini";
            reflectSpinner.classList.add('hidden');
        }
    });
});
</script>
</body>
</html>
